"use strict";!function(e,n){n.formula=function(){var t=layui.layer,i={icon:1,time:500},a={icon:2,time:2e3},c={icon:3,title:"提示"},o={maxSize:function(n,t){var i=e(t).data("size");i=i||50;var a=n&&n.length>i?"不能超过"+i+"个字符":"";return a||void 0},integer:function(e){var n=/^[\-+]?\d{1,8}$/;return e&&!n.test(e)?"无效的整数":void 0},double:function(e){var n=/^(-)?\d{1,15}(\.\d{1,2})?$/;return e&&!n.test(e)?"无效的浮点数，请保留两位小数":void 0},positive:function(e){return e&&Number(e)<0?"必须为正数":void 0},telephone:function(e){var n=/^([+][0-9]{1,3}[ .\-])?([(][0-9]{2,6}[)])?([0-9 .\-\/]{3,20})((x|ext|extension)[ ]?[0-9]{1,4})?$/;return e&&!n.test(e)?"无效的电话号码":void 0},cellphone:function(e){var n=/^1[345789]\d{9}$/;return e&&!n.test(e)?"无效的手机号码":void 0},email:function(e){var n=/^([a-zA-Z0-9_.\-])+@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return e&&!n.test(e)?"无效的邮箱地址":void 0},url:function(e){var n=/(^#)|(^http(s*):\/\/[^\s]+\.[^\s]+)/;return e&&!n.test(e)?"无效的链接地址":void 0},chinaZip:function(e){var n=/^\d{6}$/;return e&&!n.test(e)?"无效的邮政编码":void 0},before:function(n,t){return n>document.getElementById(e(t).data("target-id")).value?"必须早于"+e(t).data("target-title"):void 0},after:function(n,t){return n<document.getElementById(e(t).data("target-id")).value?"必须晚于"+e(t).data("target-title"):void 0},date:function(e){var n=/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/;return e&&!n.test(e)?"无效的日期":void 0},positiveInteger:function(e){var n=/^[+]?(\d+)$/;return e&&!n.test(e)?"无效的正整数":void 0},positiveIntegerNotExistZero:function(e){var n=/^[1-9]\d*$/;return e&&!n.test(e)?"无效的非零正整数":void 0},groupRequired:function(n,t){var i="必须要选择一项",a=t.className;return e("."+a).each(function(){i=this.checked?"":i}),i||void 0},min:function(n,t){var i=Number(e(t).data("min")),a="最小值为"+i;return n&&n<i?a:void 0},max:function(n,t){var i=Number(e(t).data("max")),a="最大值为"+i;return n&&n>i?a:void 0}},r=function(n){var t=e("#"+n),i=t.data("container")||"dataContainer";return{formId:n,containerId:i,form:t,container:e("#"+i),queryUrl:t.data("query"),method:t.data("method")||"fade",before:function(){},after:function(){}}},u=function(n){var t;if(n){if("string"==typeof n)t=r(n);else if(n instanceof Object){var i=n.formId,a=n.containerId,c=n.queryUrl,o=n.method,u=n.before,f=n.after,l=r(i);a=a||l.containerId,c=c||l.queryUrl,o=o||l.method,u=u||l.before,f=f||l.after,t={formId:i,containerId:a,form:e("#"+i),container:e("#"+a),queryUrl:c,method:o,before:u,after:f}}}else t=r("dataForm");return t},f=function(){var e=u(arguments[0]);e.form.find(":text, select, textarea").each(function(){this.value=""}),e.form.find(":radio, :checkbox").each(function(){this.checked=!1})},l=function(){var e=u(arguments[0]);console.log(e),f(e),s(e)},s=function(){var n,i=u(arguments[0]),a=i.container,c=i.queryUrl,o=i.form.serialize(),r=i.method,f=i.after,l=i.before;e.ajax({url:c,data:o,type:"post",cache:!1,async:!0,beforeSend:function(){n=t.load(2),l(!0)},success:function(i){if("fade"===r)a.hide().empty().html(i).fadeIn(10,function(){f(!0)});else if("append"===r)a.append(i),f(!0);else if("fall"===r){var c=document.createElement("div");a.append(c),e(c).hide().html(i).fadeIn(500,function(){f(!0)})}t.close(n)}})},d=function(){var t=arguments[0];t=u(t),e(n).scroll(function(){var i=e(n).scrollTop(),a=e(document).height();i+e(n).height()===a&&(e(n).off("scroll"),t.after(!0))})},m=function(n,t,i,a){a=a||function(){},e(n).slideUp(t,function(){e(this).empty().html(i).slideDown(t,function(){a(!0)})})},v=function(n,t,i,a){a=a||function(){},e(n).fadeOut(t,function(){e(this).empty().html(i).fadeIn(t,function(){a(!0)})})},p=function(n){h(n).each(function(n,t){e(t).find("input, textarea, select").each(function(){var t=e(this).prop("name");if(t){var i=[];i.push(t.substring(0,t.indexOf("[")+1)),i.push(n),i.push(t.substring(t.indexOf("]"))),e(this).prop("name",i.join(""))}})})},y=function(e,t){h(e).on("keypress",function(){var e=n.event||e;13===e.keyCode&&(e.preventDefault(),t(!0))})},h=function(n){return n instanceof jQuery?n:e(n instanceof HTMLElement?n:document.getElementById(n))},g=function(e){document.addEventListener("visibilitychange",function(){"visible"===document.visibilityState&&e(!0)})},b=function(){n.close()},k=function(e,n){t.msg(e,i,function(){n(!0)})},x=function(e,n){t.msg(e,a,function(){n(!0)})},I=function(e){var n=e.confirmMessage,i=e.successCallback instanceof Function?e.successCallback:function(){},a=e.failureCallback instanceof Function?e.failureCallback:function(){};t.confirm(n,c,function(e){t.close(e),i(!0)},function(e){t.close(e),a(!0)})},C=function(n){var i,a=n.url,c=n.params,o=n.successSilent,r=n.failureSilent,u=n.successMessage,f=n.failureMessage,l=n.successCallback instanceof Function?n.successCallback:function(){},s=n.failureCallback instanceof Function?n.failureCallback:function(){};e.ajax({url:a,data:c,type:"post",async:!1,cache:!1,beforeSend:function(){i=t.load(2)},success:function(e){t.close(i),e.success?o?l(e):(u=u||e.message,k(u,function(){l(e)})):r?s(e):(f=f||e.message,x(f,function(){s(e)}))}})};return{verifySetting:o,reset:f,query:s,resetAndQuery:l,scroll:d,toggleSlide:m,toggleFade:v,resort:p,bindEnter:y,watch:g,close:b,alertSuccess:k,alertFailure:x,confirm:I,post:C,confirmAndPost:function(e){var n=e.confirmMessage,i=e.url,a=e.params,o=e.successMessage,r=e.failureMessage,u=e.successSilent,f=e.failureSilent,l=e.successCallback,s=e.failureCallback,d=e.cancelCallback;d=d||function(){},t.confirm(n,c,function(e){t.close(e),C({url:i,params:a,successMessage:o,failureMessage:r,successSilent:u,failureSilent:f,successCallback:function(e){l(e)},failureCallback:function(e){s(e)}})},function(){d(!0)})},openDialog:function(e,n,i,a){i=i||"640px",a=a||"360px",t.open({type:2,title:e,offset:"100px",area:[i,a],shade:.8,moveType:1,content:n})},closeDialog:function(){parent.layer.close(parent.layer.getFrameIndex(n.name))},page:function(n,t,i,a,c,o){a=a||"dataForm",c=c||"pageNo",o=o||"pageSize",layui.laypage.render({elem:"page",curr:n,limit:t,limits:[10,20,50,100],count:i,layout:["count","prev","page","next","limit"],jump:function(n,t){e("#"+c).val(n.curr),e("#"+o).val(n.limit),t||formula.query(a)}})},yearPicker:function(){var n=arguments[0]||function(){};lay(".year-picker").each(function(){var t=this;layui.laydate.render({elem:t,trigger:"click",type:"year",ready:function(){},change:function(n){t.value=n,e("#layui-laydate1").remove()},done:function(e,t,i){n(e,t,i)}})})},monthPicker:function(){var n=arguments[0]||function(){};lay(".month-picker").each(function(){var t=this;layui.laydate.render({elem:t,trigger:"click",type:"month",format:"yyyy年MM月",ready:function(){},change:function(n,i){t.value=n,e(".laydate-month_report-list li").on("click",function(){e(".laydate-btns-confirm").click()})},done:function(e,t,i){n(e,t,i)}})})},datePicker:function(){var e=arguments[0]||function(){};lay(".date-picker").each(function(){layui.laydate.render({elem:this,trigger:"click",done:function(n,t,i){e(n,t,i)}})})},datetimePicker:function(){var e=arguments[0]||function(){};lay(".datetime-picker").each(function(){layui.laydate.render({elem:this,trigger:"click",type:"datetime",done:function(n,t,i){e(n,t,i)}})})}}}()}($,window);